<!DOCTYPE html><html lang="en-Us"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="baidu-site-verification" content="1EB8XoOl0C" /><title> eshenhu's blog</title><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="description" content="It never be later than do nothing"><meta name="keywords"><meta name="author" content="eshenhu"><link rel="short icon" href="/images/favicon.ico"><link rel="stylesheet" href="/css/bubuzou.css"><link rel="search" type="application/opensearchdescription+xml" href="https://eshenhu.github.io/atom.xml" title="eshenhu's blog"></head><body><header><div class="header row"> <a href="/" class="logo-link"><img src="/images/logo.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" data-hover="博文" class="nav-list-link">博文</a></li><li class="nav-list-item"><a href="/archives/" target="_self" data-hover="归档" class="nav-list-link">归档</a></li><li class="nav-list-item"><a href="/categories/live/" target="_self" data-hover="生活" class="nav-list-link">生活</a></li><li class="nav-list-item"><a href="/categories/film/" target="_self" data-hover="摄影" class="nav-list-link">摄影</a></li><li class="nav-list-item"><a href="/about/" target="_self" data-hover="关于" class="nav-list-link">关于</a></li></ul><div class="search"><a id="search_btn" href="#search"></a></div></div></header><div class="row scroll-con"><section class="container"><!-- for archive page--><ul class="home post-list"><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2018/05/16/build-lightweight-network-monitor-tools/" class="post-title-link">build lightweight network monitor tools</a></h2><div class="post-info">2018-05-16 23:14</div><div class="post-content"><h1 id="Motivation"><a href="#Motivation" class="headerlink" title="Motivation"></a>Motivation</h1><p>Recently my project need a lightweight network monitor tools to peek at the network activity, some basic requirements was list as following:</p>
<ul>
<li>Provide basic network/interface SDK to the application.</li>
<li>The service need provide the report on activities on the network, like <ul>
<li>interface modification, add/del/modify including ip changes, mac changes, new interface added, etc</li>
<li>network connectiong status, stale/reachable</li>
</ul>
</li>
<li>Extensibility and decouple serive and client, easy to intergrate other service. </li>
<li>Lightweight, less CPU usage and memory usage.</li>
</ul>
<p>After google some open source projects, I found it seems like no one can fit my requirement, but the iproute2 project was quite fit my requirement. So, why we don’t make iproute2 as a library?</p>
<p>I list the <em>Pros</em> and <em>Cons</em> if use iproute2 as library:</p>
<p>Pros:</p>
<ul>
<li>No need to write the socket layer code.</li>
<li>More or even more information about network interfaces can be got. Same functionality with the iproute2 tools.</li>
<li>Simple API interface.</li>
</ul>
<p>Cons:</p>
<ul>
<li>iproute2-as-lib library size is big. ~500kb.</li>
</ul>
<p>GitHub:<br>  <a href="https://github.com/eshenhu/iproute2_as_lib" target="_blank" rel="external">iprout2_as_lib</a></p>
<p>Enjoy it!<br></div><a href="/2018/05/16/build-lightweight-network-monitor-tools/" class="read-more">...more</a></article></li><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2017/12/28/Build-your-private-LTE-network-for-IIOT/" class="post-title-link">Build your private LTE network for IIOT</a></h2><div class="post-info">2017-12-28 17:15</div><div class="post-content"><p><em>Abstract</em>:</p>
<blockquote>
<p>In some specfied conditions, the tele operator is considering share/reserve some spectrum resource to the IIOT(Industry IoT)applicance, like the NB-IoT/eMTC tech defined by 3GPP stardard.<br>In this article, we present a solution on how to offload LTE with Selected IP tracffic offload(SIPTO) tech, which provide another practical solution beside the traditional LTE macro cell deployment. This deployment will save the investment and simplify the Network Element deloyment, as well as increase the KPI in local factory.</p>
</blockquote>
<p><em>Keywords</em>: SIPTO, LIPA, IMobile Data Offloading</p>
<h3 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h3><p>With the increase of cost spent in thse back-haul equipment(either in the urban area or in the low-intensity population area), more and more operator will like consider using the existed cable provider (like Comcast in US) as their back-haul alternatively. Specially FTTH and other PON technology become more and more popular, cable operator can provide relatively high QoS now.</p>
<p>3GPP present the TS23.829 as the guide to the HeNB manufacture how to deploy the off-load infrastructure cooperating with the macro cell to reach the best experience to the end-user. </p>
<p>Along with the population of Industry 4.0 and edge-computing, more and more geography-fixed device has the requirement to access the network with QoS and throughput. Specially in the smart-factory setup,  they want to rent the telcomm wireless network within their factory-domain or running their owned private wireless network.<br>Specially, the vCPEs in the same eNodeB want to intercommunicate to each other, which means the traffic happened between those vCPEs will not route outside of local domain. for example, in the steaming video like IPTV services in the set-top box, each app was used with P2P technology, locate gateway offloading and vCPEs interconnection each other is a big cons to the end-user’s experience.<br>In some industry area, the end sensors, robots or equipments will generate huge data per day, the factory owner will be careful to consider use, like LTE network as their connecting method. even most of data will not access outside of factory.<br>With this kind of deloyment, the operator will reduce stress on the network and make better profit on the IIoT revolution.</p>
<img src="/2017/12/28/Build-your-private-LTE-network-for-IIOT/00_network_deployment.png" alt="network_deployment" title="network_deployment">
<p>As a summary, some characters were:</p>
<ul>
<li>SON (automatically select the proper wireless configuration)</li>
<li>Traffic local Gateway offloading.</li>
<li>vCPE inter accessibility in the eNodeBs managed by a same LGW.</li>
</ul></div><a href="/2017/12/28/Build-your-private-LTE-network-for-IIOT/" class="read-more">...more</a></article></li><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2017/11/22/Build-service-with-SOA-in-Openwrt/" class="post-title-link">Build service with SOA in Openwrt</a></h2><div class="post-info">2017-11-22 18:51</div><div class="post-content"><p>In one of internal technical review meeting, the coder integrate the service into a existed substance/service, but considering of the scalability of this service, I strongly recommended the developer decouple this service from any substance and made them into a self-contained substance in order to provide the service to more clients in the future. </p>
<p>##SOA in practice<br> In the wikipedia <a href="https://en.wikipedia.org/wiki/Service-oriented_architecture" target="_blank" rel="external">page</a>, SOA was needed to meet the following basic rules.</p>
<blockquote>
<p>A service has four properties according to one of many definitions of SOA:</p>
<ul>
<li>It logically represents a business activity with a specified outcome.</li>
<li>It is self-contained.</li>
<li>It is a black box for its consumers.</li>
<li>It may consist of other underlying services.</li>
</ul>
</blockquote>
<p>In the resource-limited SoC, it maybe not practical to deploy individual service with one standalone process,  but it will be possible deploying partly/all services in one process and multiplexed the service using the different domain/interface id.<br></div><a href="/2017/11/22/Build-service-with-SOA-in-Openwrt/" class="read-more">...more</a></article></li><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2017/11/02/Design-a-license-system-in-embedded-system/" class="post-title-link">Design a license system in embedded system</a></h2><div class="post-info">2017-11-02 18:14</div><div class="post-content"><blockquote>
<p><code>License</code> was widely used on many software/hardware area, such as Microsoft Windows Series, which use dedicated hardware to store their key and other information to verify the booting OS is legal or not. Dell or EMC or Oracle Database use license to limit how many HW resource can be used. So, <code>license</code> system is an valuable assert to the company as it can bring the direct profit.</p>
</blockquote>
<h2 id="Aspects-when-designing-license-system"><a href="#Aspects-when-designing-license-system" class="headerlink" title="Aspects when designing license system"></a>Aspects when designing license system</h2><ul>
<li>Security</li>
<li>Compatible </li>
</ul>
<h2 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h2><p>In common, the company would like to design a universal HW platform to carry on different requirements with the reason of decreasing the complex of BOM, leverage the cost on HW expense, etc. In order to make more profit on a universal hardware platform, then you need a license system to give the right authority to your sales/customer. For example, in the wireless system, some company would like sale the HW without any charge or very low price, but those HW only can carry on low volume data/service in the <code>BASIC</code> state, f.g. LTE station in <code>BASIC</code> mode only can take 16 Users in one BST,  a limited throughput, a limited Cells can be setup. Basically,  you had to buy a suitable license paper meeting your requirement, just like the menu in the restaurant, you can’t image how many menus did the company make ready for you.<br>In one word, License can make money!!!</p></div><a href="/2017/11/02/Design-a-license-system-in-embedded-system/" class="read-more">...more</a></article></li><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2017/10/23/Fast-logging-system-in-embedded-system/" class="post-title-link">Fast logging system in embedded system</a></h2><div class="post-info">2017-10-23 21:04</div><div class="post-content"><h1 id="Fast-logging-system-in-embedded-system"><a href="#Fast-logging-system-in-embedded-system" class="headerlink" title="Fast logging system in embedded system"></a>Fast logging system in embedded system</h1><hr>
<p>[TOC]</p>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>FLOG is a light-weight logging system which has features like, high throughput, non-blocking and lock-less write from different process, crash save in field. It is suitable for the embedded system using Linux system.</p>
<h2 id="Log-VS-Trace"><a href="#Log-VS-Trace" class="headerlink" title="Log VS. Trace"></a>Log VS. Trace</h2><p><strong>Log</strong> was used as recording the activity on subsystem, it provide the activity information to the system administrator or operator to give them a preview on the activity. such as booting information when kernel boot, plug-in-plug-out event popup by kernel.</p>
<img src="/2017/10/23/Fast-logging-system-in-embedded-system/log_sample.png" alt="Picture-01" title="Picture-01">
<p><strong>Trace</strong> was used as recording detailed information on specified system, its main purpose is used as tracking the detail into this system, the output which it generate was used by programmer to analysis what is going on when some problem happened. In common occurrence, it only be requested when system was not working as expected, such as the throughput was not reached into the theory level in wireless card, etc.</p></div><a href="/2017/10/23/Fast-logging-system-in-embedded-system/" class="read-more">...more</a></article></li><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2017/08/16/System-test-thoughts/" class="post-title-link">system test thoughts</a></h2><div class="post-info">2017-08-16 23:33</div><div class="post-content"><h1 id="谈谈如何有效的测量系统负载和响应"><a href="#谈谈如何有效的测量系统负载和响应" class="headerlink" title="谈谈如何有效的测量系统负载和响应"></a>谈谈如何有效的测量系统负载和响应</h1><p>嵌入式系统在系统测试过程中往往需要进行 Stability, Robustness, Accessbility, Responsibility 等等系统测试. 以来保证系统的功能完整性和健壮性. </p>
<p>嵌入式系统在设计在立项阶段会给出一个设计目标, 比如一款路由器，往往会给出以下类似的要求:</p>
<ul>
<li>支持 802.11n/g/a/b 支持.</li>
<li>支持 2.4G, 5G 双频.</li>
<li>最大速率支持 (450Mbps).</li>
<li>…</li>
</ul>
<p>作为系统设计者,需要在设计阶段锚定这些目标进行技术选型. 如果当前有类似产品设计经验, 可以借鉴之前的经验进行选型. 如果是第一次设计, 保守的做法便是借鉴其他厂商的方案, 等待自己对系统了解的加深和经验的丰富再进行下一阶段的开发. </p>
<p>无论以什么方式开局, 一个 ·能用· ·易用· ·好用· 的测试环境是必须要在第一时间阶段准备, 才能应对产品开发阶段的各项挑战.</p>
<p>结合我手中的几个项目, 想谈谈自己的一点关于系统测试的看法.</p></div><a href="/2017/08/16/System-test-thoughts/" class="read-more">...more</a></article></li><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2017/06/26/Some-thoughts-about-memory-issue/" class="post-title-link">Some thoughts about memory issue</a></h2><div class="post-info">2017-06-26 22:27</div><div class="post-content"><p>最近一段时间在忙于内存问题的事情，算是有些成果输出吧。借机谈论一下自己的感想。</p>
<p>近来工程团队遇到几次比较严重的内存泄漏问题,有一些问题无疾而终.在接手工作后发现这些问题均是发生<br>在客户的现场,很难在实验室复现. 即使能够在长时间stability测试发现问题，因为现场发生比较遥远，<br>也是很难去定位问题. 针对此类问题,团队近期输出了几个内部产品, 较好的解决了其中的一些问题。</p></div><a href="/2017/06/26/Some-thoughts-about-memory-issue/" class="read-more">...more</a></article></li><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2017/06/05/Efficient-data-transfer-through-zero-copy/" class="post-title-link">Efficient data transfer through zero copy</a></h2><div class="post-info">2017-06-05 00:21</div><div class="post-content"><h2 id="Zero-copy-I-O-practice-in-project"><a href="#Zero-copy-I-O-practice-in-project" class="headerlink" title="Zero-copy I/O practice in project"></a>Zero-copy I/O practice in project</h2><p>Recently weeks, I was working on how to exploit the potentialities with the GMAC(1G Ethernet Media Access Controller)  on the SoC in my desktop. This SoC was used in the telecommunication field which provide the fast-transfer-data capability with some interesting MAC features. In this article, I had like share some experiences on how to utilize this MAC achieving better network throughput during this work.</p>
<h2 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h2><p>@[Blog]</p>
<p>The following articles were worth having a look before going forward.</p>
<ul>
<li><a href="http://www.linuxjournal.com/article/6345" target="_blank" rel="external">Zero Copy I: User-Mode Perspective </a> (from Linux Journal, strongly recommended to read)</li>
<li><a href="http://dl.acm.org/citation.cfm?id=974947" target="_blank" rel="external">An Efficient Zero-Copy I/O Framework for UNIX</a> (most of thoughts comes from here)</li>
</ul></div><a href="/2017/06/05/Efficient-data-transfer-through-zero-copy/" class="read-more">...more</a></article></li><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2017/06/04/don-t-use-memset-init-your-struct/" class="post-title-link">don't use memset() init your struct</a></h2><div class="post-info">2017-06-04 22:17</div><div class="post-content"><h2 id="Don’t-use-memset-init-your-struct"><a href="#Don’t-use-memset-init-your-struct" class="headerlink" title="Don’t use memset init your struct"></a>Don’t use memset init your struct</h2><p>Even in some open source project, we always see <code>memset</code> filled in the code, here I had like give the reason why we should not use <code>memset</code> if possible.</p></div><a href="/2017/06/04/don-t-use-memset-init-your-struct/" class="read-more">...more</a></article></li><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2017/06/04/hello-world/" class="post-title-link">Hello World</a></h2><div class="post-info">2017-06-04 12:27</div><div class="post-content"></div><a href="/2017/06/04/hello-world/" class="read-more">...more</a></article></li></ul><div class="right-container"><div class="widget"><div class="category"><h4>分类归档</h4></div></div><div class="widget"><div class="tagcloud"><h4>标签云</h4><a href="/tags/Language/" style="font-size: 10px;">Language</a> <a href="/tags/SIPTO-LIPA-IMobile-Data-Offloading/" style="font-size: 10px;">SIPTO LIPA IMobile Data Offloading</a></div></div><div class="widget"><div class="recent"><h4>最近文章</h4><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/05/16/build-lightweight-network-monitor-tools/">build lightweight network monitor tools</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/28/Build-your-private-LTE-network-for-IIOT/">Build your private LTE network for IIOT</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/22/Build-service-with-SOA-in-Openwrt/">Build service with SOA in Openwrt</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/02/Design-a-license-system-in-embedded-system/">Design a license system in embedded system</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/23/Fast-logging-system-in-embedded-system/">Fast logging system in embedded system</a></li></ul></div></div><div class="widget"><div id="arAnchorBar"></div></div></div></section></div><div class="right-menu"></div><div class="modal search-modal"><div class="input-field"><input type="text" id="search_input"><label for="search-input">搜索</label></div><div id="search_result" class="search-result"></div></div><div class="blog-overlay"></div><footer class="row"><div class="footer-con"><div class="paginator"></div><div class="copyright"><p>© 2016 - 2018 <a target="_blank">eshenhu</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> <br> and <a href="https://github.com/Bulandent/hexo-theme-bubuzou" target="_blank">hexo-theme-bubuzou</a>.</p></div><div class="totop"><i></i></div></div></footer><script async src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script src="/scripts/jquery-1.8.2.min.js"></script><script src="/scripts/arAnchor.js"></script><script src="/scripts/main.js"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>